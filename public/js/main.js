!function(){"use strict";function e(e,s=!1,r=!1,n={}){r&&t(r,n);for(let r of e)r.addEventListener("click",(e=>{const n=r.parentElement.parentElement.getAttribute("aria-labelledby"),o=e.target.innerText;if(document.querySelector(`#${n}`).innerText=o,s){const e=document.querySelectorAll(".form__input");document.querySelector("#visitModalDropdownMenuDoctors").style.borderColor="",e.forEach((e=>{e.style.borderColor=""})),t(r.textContent)}}))}function t(e,{lastVisit:t,pressure:s,lastPressure:r,age:n}={}){const o=document.querySelectorAll(".inserted-field");o&&o.forEach((e=>{e.remove()}));const i=document.querySelector(".modal-body");"Dentist"===e?i.insertAdjacentHTML("beforeend",`<input type="text"\n            name="last visit date"\n            class="form__input inserted-field" id="userLastVisit"\n            placeholder="Last visit date" value="${t||""}">`):"Cardiologist"===e?i.insertAdjacentHTML("beforeend",`<input type="text"\n            name="pressure"\n            class="form__input inserted-field" id="userPressure"\n            placeholder="Pressure" value="${s||""}">\n\n            <input type="text"\n            name="age"\n            class="form__input inserted-field" id="userAge"\n            placeholder="Age" value="${n||""}">\n\n            <textarea class="form__input inserted-field" \n            placeholder="Past cardiovascular diseases"\n            id="userLastPressure"\n            rows="3">${r||""}</textarea>`):"Physician"===e&&i.insertAdjacentHTML("beforeend",`<input type="text"\n            name="age"\n            class="form__input inserted-field" id="userAge"\n            placeholder="Age" value="${n||""}">`)}e(document.querySelectorAll(".options__input-container .options__dropdown-item"));var s=e,r=class{constructor(e){this.modalName=e}render(){const e=`<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">\n        \x3c!-- Modal --\x3e\n        <div class="modal-dialog modal-dialog-centered">\n            <div class="modal-content form">\n                <div class="modal-header form__header">\n                    <div class="form__green-box"></div>\n                    <h5 class="modal-title" id="exampleModalLabel">\n                        ${this.modalName}\n                    </h5>\n                    <button type="button" class="btn-close form__btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body form__body"></div>\n                <div class="modal-footer form__footer">\n                    <button type="submit" class="btn btn-lg form__submit-bnt">\n                        ${this.modalName}\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>`;document.body.insertAdjacentHTML("afterbegin",e),document.querySelector(".form__btn-close").addEventListener("click",this.clearInputs)}hideModal(){const e=document.getElementById("exampleModal"),t=document.querySelector(".modal-backdrop");e.classList.remove("show"),setTimeout((function(){e.remove()}),500),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight="",t&&t.remove()}clearInputs(){setTimeout((function(){document.querySelectorAll(".form__input").forEach((e=>e.remove()))}),500)}},n=class{createElement(e,t,s,r){const n=document.createElement(e);return s&&(n.textContent=s),n.classList.add(...t),r&&(n.id=r),n}},o=({url:e,data:t,options:s={}})=>fetch(e,{method:"GET",...s,headers:{"Content-Type":"application/json",Authorization:"Bearer b79f9492-9e9f-4a4b-81ba-12700a39115e"},body:JSON.stringify(t)}),i=class extends r{constructor(e){super(e),this.modalName=e}render({name:e,status:t,doctor:r,problem:n,id:o,description:i,lastVisit:a,pressure:d,lastPressure:c,age:l}={}){const u=document.querySelector("#exampleModalLabel"),m=document.querySelector(".form__submit-bnt");u.textContent=`${this.modalName}`,m.textContent=`${this.modalName}`;const p=document.querySelector(".form__body"),h=document.querySelector("#exampleModal"),_=document.querySelector(".form__btn-close"),b=`<div class="dropdown form__input visit-modal" data-id="${o}">\n        <button class="dropdown-toggle" type="button" \n        id="visitModalDropdownMenuDoctors" data-bs-toggle="dropdown" \n        data-bs-auto-close="true" aria-expanded="false">\n            ${r||"Choose a doctor"}\n        </button>\n        <ul class="dropdown-menu options__dropdown-menu" \n        aria-labelledby="visitModalDropdownMenuDoctors">\n            <li>\n                <a class="options__dropdown-item form__dropbox-item dropdown-item" href="#">Cardiologist</a>\n            </li>\n            <li>\n                <a class="options__dropdown-item form__dropbox-item dropdown-item" href="#">Dentist</a>\n            </li>\n            <li>\n                <a class="options__dropdown-item form__dropbox-item dropdown-item" href="#">Physician</a>\n            </li>\n        </ul>\n    </div>\n    <input\n            type="text"\n            name="purpose"\n            class="form__input"\n            placeholder="The purpose of visit"\n            id="userProblem"\n            value="${n||""}"\n        />\n        <textarea class="form__input" \n        placeholder="Short description"\n        id="userDescription"\n        rows="3">${i||""}</textarea>\n        <input\n            type="text"\n            name="name"\n            class="form__input"\n            placeholder="Name, Surname"\n            id="userName"\n            value="${e||""}"\n        />\n        ${t?this.checkVisitStatus(t):""}`;p.insertAdjacentHTML("beforeend",b);const f=document.querySelector("#status-btn"),y=document.querySelectorAll(".visit-modal .options__dropdown-item");s(y,!0,r,{lastVisit:a,pressure:d,lastPressure:c,age:l}),_.addEventListener("click",this.hideModal),f&&f.addEventListener("click",(()=>{"Open"===f.dataset.status?(f.classList.remove("form__status-btn--green"),f.classList.add("form__status-btn--red"),f.textContent="Status: Done",f.dataset.status="Done"):(f.classList.remove("form__status-btn--red"),f.classList.add("form__status-btn--green"),f.textContent="Status: Open",f.dataset.status="Open")})),h.addEventListener("click",(e=>{const t=e.target;try{if("exampleModal"===t.id)this.hideModal();else if("Create visit"===t.innerText&&"button"===t.localName){if(this.checkInputsValue())return;this.sendRequest("POST")}else if("Edit"===t.innerText&&"button"===t.localName){if(this.checkInputsValue())return;const e=document.querySelector(".visit-modal");this.sendRequest("PUT",f.dataset.status,e.dataset.id)}}catch(e){document.querySelector("#visitModalDropdownMenuDoctors").style.borderColor="red"}}))}hideModal(){super.hideModal(),super.clearInputs(),super.render()}checkVisitStatus(e){return"Open"===e?'<button class="form__input form__status-btn form__status-btn--green" id="status-btn" data-status="Open">Status: Open</button>':"Done"===e?'<button class="form__input form__status-btn form__status-btn--red" id="status-btn" data-status="Done">Status: Done</button>':void 0}repeatValues(){this.wrapper=document.body.querySelector(".modal-content"),this.userProblem=this.wrapper.querySelector("#userProblem").value,this.userDescription=this.wrapper.querySelector("#userDescription").value,this.userName=this.wrapper.querySelector("#userName").value,this.userDoctor=document.getElementById("visitModalDropdownMenuDoctors").innerText}takeValuesInput(){return this.repeatValues(),"Dentist"===this.userDoctor?(this.userLastVisit=this.wrapper.querySelector("#userLastVisit").value,{name:this.userName,problem:this.userProblem,description:this.userDescription,doctor:this.userDoctor,status:"Open",lastVisit:this.userLastVisit}):"Cardiologist"===this.userDoctor?(this.userPressure=this.wrapper.querySelector("#userPressure").value,this.userLastPressure=this.wrapper.querySelector("#userLastPressure").value,this.userAge=this.wrapper.querySelector("#userAge").value,{name:this.userName,problem:this.userProblem,description:this.userDescription,doctor:this.userDoctor,status:"Open",pressure:this.userPressure,lastPressure:this.userLastPressure,age:this.userAge}):"Physician"===this.userDoctor?(this.userAge=this.wrapper.querySelector("#userAge").value,{name:this.userName,problem:this.userProblem,description:this.userDescription,doctor:this.userDoctor,status:"Open",age:this.userAge}):void 0}sendRequest(e,t,s){const r="https://ajax.test-danit.com/api/v2/cards",n=`https://ajax.test-danit.com/api/v2/cards/${s}`,{name:i,status:a,doctor:d,problem:c,description:l,lastVisit:u,pressure:m,lastPressure:p,age:h}=this.takeValuesInput();"Dentist"===d&&o({url:"PUT"===e?n:r,data:{name:i,status:t||a,doctor:d,problem:c,description:l,lastVisit:u},options:{method:`${e}`}}),"Cardiologist"===d&&o({url:"PUT"===e?n:r,data:{name:i,status:t||a,doctor:d,problem:c,description:l,pressure:m,lastPressure:p,age:h},options:{method:`${e}`}}),"Physician"===d&&o({url:"PUT"===e?n:r,data:{name:i,status:t||a,doctor:d,problem:c,description:l,age:h},options:{method:`${e}`}}),document.querySelector(".desk__items-container").innerHTML="",this.hideModal(),setTimeout((()=>{_()}),200)}checkInputsValue(){const e=document.querySelectorAll(".form__input");let t=!1;return e.forEach((e=>{""===e.value&&"status-btn"!==e.id&&(e.style.borderColor="red",t=!0)})),t}},a=class extends r{constructor(e,{name:t,status:s,doctor:r,problem:n,id:o,description:i,lastVisit:a,pressure:d,lastPressure:c,age:l}){super(e),this.modalName=e,this.name=t,this.status=s,this.doctor=r,this.problem=n,this.id=o,this.description=i,this.lastVisit=a,this.pressure=d,this.lastPressure=c,this.age=l}render(){const e=document.querySelector(".form__body"),t=document.querySelector(".form__submit-bnt"),s=document.querySelector("#exampleModalLabel"),r=document.querySelector(".form__btn-close"),n=document.querySelector("#exampleModal");s.textContent=`${this.modalName}`,t.style.display="none",e.insertAdjacentHTML("beforeend",`<p class="form__input">Doctor: ${this.doctor}</p>\n            <p class="form__input">The purpose of visit: ${this.problem}</p>\n            <p class="form__input">Short description: ${this.description}</p>\n            <p class="form__input">Name: ${this.name}</p>`),"Dentist"===this.doctor?e.insertAdjacentHTML("beforeend",`<p class="form__input">Last visit date: ${this.lastVisit}</p>`):"Physician"===this.doctor?e.insertAdjacentHTML("beforeend",`<p class="form__input">Age: ${this.age}</p>`):"Cardiologist"===this.doctor&&e.insertAdjacentHTML("beforeend",`<p class="form__input">Pressure: ${this.pressure}</p>\n                <p class="form__input">Age: ${this.age}</p>\n                <p class="form__input">Past cardiovascular diseases: ${this.lastPressure}</p>`),"Open"===this.status?e.insertAdjacentHTML("beforeend",'<button class="form__input form__status-btn \n                form__status-btn--green form__status-btn--cursor-default" \n                id="status-btn" data-status="Open">Status: Open</button>'):"Done"===this.status&&e.insertAdjacentHTML("beforeend",'<button class="form__input form__status-btn form__status-btn--red \n                form__status-btn--cursor-default" id="status-btn" \n                data-status="Done">Status: Done</button>'),r.addEventListener("click",this.clearInputs),n.addEventListener("click",(e=>{"exampleModal"===e.target.id&&this.clearInputs()}))}clearInputs(){super.clearInputs();const e=document.querySelector(".form__submit-bnt");setTimeout((function(){e.style.display=""}),500)}},d=class extends n{constructor(){super(),this.container=document.querySelector(".desk__items-container"),this.handlerButtons()}handlerButtons(){this.container.addEventListener("click",(e=>{e.preventDefault(),this.item=e.target,"BUTTON"===this.item.tagName&&(this.itemId=this.item.closest(".item").dataset.id,this.deleteItem(),this.moreInfoBtn(),this.editBtn())}))}values(){this.wrapper=this.item.closest(".item__container"),this.name=this.wrapper.querySelector(".item__name").innerText,this.doctor=this.wrapper.querySelector(".item__doctor span").innerText,this.status=this.wrapper.querySelector(".item__status span").innerText,this.description=this.wrapper.querySelector(".content-extra__description").innerText,this.problem=this.wrapper.querySelector(".content-extra__problem").innerText}currentDoctorValues(){return"Dentist"===this.doctor?(this.lastVisit=this.wrapper.querySelector(".content-extra__lastVisit").innerText,{id:this.itemId,status:this.status,name:this.name,doctor:this.doctor,problem:this.problem,description:this.description,lastVisit:this.lastVisit}):"Cardiologist"===this.doctor?(this.pressure=this.wrapper.querySelector(".content-extra__pressure").innerText,this.lastPressure=this.wrapper.querySelector(".content-extra__lastPressure").innerText,this.age=this.wrapper.querySelector(".content-extra__age").innerText,{id:this.itemId,name:this.name,doctor:this.doctor,status:this.status,problem:this.problem,description:this.description,pressure:this.pressure,lastPressure:this.lastPressure,age:this.age}):"Physician"===this.doctor?(this.age=this.wrapper.querySelector(".content-extra__age").innerText,{id:this.itemId,status:this.status,name:this.name,doctor:this.doctor,problem:this.problem,description:this.description,age:this.age}):void 0}deleteItem(){this.item.dataset.del&&(o({url:`https://ajax.test-danit.com/api/v2/cards/${this.itemId}`,options:{method:"DELETE"}}),this.item.closest(".col").remove())}moreInfoBtn(){if(!this.item.dataset.moreinfo)return;this.values();const e=this.currentDoctorValues();new a("More Info",e).render()}editBtn(){if(!this.item.dataset.edit)return;const e=new i("Edit");this.values();const{name:t,status:s,doctor:r,problem:n,id:o,description:a,lastVisit:d,pressure:c,lastPressure:l,age:u}=this.currentDoctorValues();e.render({name:t,status:s,doctor:r,problem:n,id:o,description:a,lastVisit:d,pressure:c,lastPressure:l,age:u})}};class c{constructor(){}renderVisit(e){return`<p class="content-extra__lastVisit">${e}</p>`}}class l{constructor(){}renderVisit(e,t,s){return`<p class="content-extra__pressure">${t}</p>\n              <p class="content-extra__lastPressure">${s}</p>\n              <p class="content-extra__age">${e}</p>`}}class u{constructor(){}renderVisit(e){return`<p class="content-extra__age">${e}</p>`}}var m=class extends n{constructor({id:e,name:t,doctor:s,description:r,problem:n,age:o,lastVisit:i,pressure:a,lastPressure:d,status:c="Open"}){super(),this.name=t,this.description=r,this.problem=n,this.age=o,this.lastVisit=i,this.pressure=a,this.lastPressure=d,this.doctor=s,this.status=c.toLowerCase(),this.id=e,this.container=document.querySelector(".desk__items-container")}createCard(){this.item=this.createElement("div",["item"]),this.wrapper=this.createElement("div",["col","remove-padding"]),this.item.setAttribute("data-id",this.id),this.item.dataset.doctor=this.doctor,this.item.dataset.status=this.status,this.item.innerHTML=`\n    <div class="item__container">\n        <div class="item__content">\n            <h3 class="item__name">${this.name}</h3>\n            <p class="item__doctor">Doctor's appointment: <span>${this.doctor}</span></p>\n            <p class="item__status">Status: ${this.checkedStatus()}</p>\n            <div class="content-extra">\n                <p class="content-extra__problem">${this.problem?this.problem:""}</p>\n                <p class="content-extra__description">${this.description?this.description:""}</p>\n                ${this.extraContent()}\n            </div>\n        </div>\n        <div class="item__buttons">\n            <button class="button-delete" data-del="delete"></button>\n            <button class="button-moreInfo" data-moreInfo="moreInfo" data-bs-toggle="modal" data-bs-target="#exampleModal">More info</button>\n            <button class="button-edit" data-edit="edit" data-bs-toggle="modal" data-bs-target="#exampleModal">Edit</button>\n        </div>\n    </div>\n    `,this.wrapper.prepend(this.item),this.container.prepend(this.wrapper)}checkedStatus(){return this.blockInner="","open"===this.status?(this.blockInner='<span class="status-green">Open</span>',this.item.classList.remove("status-done")):(this.blockInner='<span class="status-red">Done</span>',this.item.classList.add("status-done")),this.blockInner}extraContent(){return"Dentist"===this.doctor?(new c).renderVisit(this.lastVisit):"Cardiologist"===this.doctor?(new l).renderVisit(this.age,this.pressure,this.lastPressure):"Physician"===this.doctor?(new u).renderVisit(this.age):""}};function p(){const e=document.querySelector("#search-input"),t=document.querySelector("#dropdownMenuDoctors"),s=document.querySelector("#dropdownMenuStates"),r=document.querySelectorAll(".item"),n=document.querySelectorAll(".item__name"),o=document.querySelector(".desk__items-container"),i=o.querySelector(".no-visits");i&&i.remove(),n.forEach((e=>e.innerHTML=e.innerText)),r.forEach((e=>e.closest(".col").classList.add("card-hidden")));const a=Array.from(r).filter((t=>{const s=t.querySelector(".item__name"),r=s.innerText.toLowerCase(),n=e.value.toLowerCase().trim();if(""===n)return t;if(-1!==r.search(n)){let e=s.innerText;return s.innerHTML=function(e,t,s){return e.slice(0,t)+'<mark class="search-mark">'+e.slice(t,t+s)+"</mark>"+e.slice(t+s)}(e,r.search(n),n.length),t}})).filter((e=>{const s=t.innerText;return"All doctors"===s?e:e.dataset.doctor===s})).filter((e=>{const t=s.innerText,r=t.slice(t.indexOf(" ")+1).toLowerCase();return"all"===r?e:e.dataset.status===r}));if(0===a.length){const e=document.createElement("div");e.classList.add("no-visits"),e.innerText="No visits have been found",o.append(e)}a.forEach((e=>{e.closest(".col").classList.remove("card-hidden")}))}var h=()=>{const e=document.querySelector("#search-input"),t=document.querySelector("#search-btn");document.querySelectorAll("[disabled=true]").forEach((e=>e.disabled=!1)),t.addEventListener("click",p),e.addEventListener("input",(()=>{""===e.value.trim()&&p()})),document.addEventListener("keydown",(e=>{"Enter"===e.code&&(e.preventDefault(),p())}))};async function _(){const e=await o({url:"https://ajax.test-danit.com/api/v2/cards"}),t=await e.json();console.log(t),t.forEach((({name:e,status:t,doctor:s,problem:r,id:n,description:o,lastVisit:i,pressure:a,lastPressure:d,age:c})=>{new m({name:e,status:t,doctor:s,problem:r,id:n,description:o,lastVisit:i,pressure:a,lastPressure:d,age:c}).createCard()}))}function b(){const e=document.getElementById("create-visit-btn"),t=new r,s=new i("Create visit");t.render(),e.addEventListener("click",(()=>{s.render()}))}class f extends r{render(){const e=document.querySelector(".form__body"),t=document.querySelector(".form__btn-close"),s=document.querySelector("#exampleModal");e.insertAdjacentHTML("afterbegin",'<input\n        type="text"\n        name="name"\n        class="form__input"\n        placeholder="Enter your name"\n        id="log-in__name"\n    />\n    <input\n        type="password"\n        name="password"\n        class="form__input"\n        placeholder="Enter your password"\n        id="log-in__password"\n    />\n    <label class="form__checkbox-text">\n        <input\n            type="checkbox"\n            name="checkbox"\n            class="form__checkbox"\n        />\n        Remember me\n    </label>'),t.addEventListener("click",this.clearInputs),s.addEventListener("click",(e=>{"exampleModal"===e.target.id&&this.clearInputs()}))}getLogIn(){document.querySelector(".form__submit-bnt").addEventListener("click",(()=>{if(!function(){const e=document.getElementById("log-in__name"),t=document.getElementById("log-in__password");let s=!1;return[{name:"Kate",password:"kate2002"}].forEach((r=>{const{name:n,password:o}=r;n.toLocaleLowerCase()!==e.value.toLocaleLowerCase()||o!==t.value?(e.style.borderColor="red",t.style.borderColor="red"):s=!0})),s}())return;const e=document.querySelector(".form__checkbox");super.hideModal(),v.insertAdjacentHTML("afterend",y),v.remove(),e.checked&&localStorage.setItem("rememberMe","true"),_(),new d,h(),b()}))}hideModal(){super.hideModal()}clearInputs(){super.clearInputs();const e=document.querySelector(".form__checkbox-text");setTimeout((function(){e.remove()}),500)}}window.addEventListener("load",(()=>{if(localStorage.getItem("rememberMe"))return v.insertAdjacentHTML("afterend",y),v.remove(),_(),new d,h(),void b();new r("Log In").render();const e=new f;e.getLogIn(),v.addEventListener("click",(()=>{e.render()}))}));const y='<button id="create-visit-btn"\n    class="header__button" data-bs-toggle="modal" \n    data-bs-target="#exampleModal"\n    >Create Visit</button>',v=document.getElementById("log-in-btn")}();